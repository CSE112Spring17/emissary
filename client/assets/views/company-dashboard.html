<!DOCTYPE html>
<html lang="en">
<head>
    <script src = "assets/native/js/shared.js"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Neon Admin Panel" />
    <meta name="author" content="" />

    <link rel="icon" href="assets/images/logo-omni.png">

    <title>Emissary | Dashboard</title>
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="assets/js/jquery-ui/css/no-theme/jquery-ui-1.10.3.custom.min.css">
    <link rel="stylesheet" href="assets/css/font-icons/entypo/css/entypo.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic">
    <link rel="stylesheet" href="assets/native/css/shared-dashboard.css">
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <link rel="stylesheet" href="assets/css/neon-core.css">
    <link rel="stylesheet" href="assets/css/neon-theme.css">
    <link rel="stylesheet" href="assets/css/neon-forms.css">
    <link rel="stylesheet" href="assets/css/custom.css">
    <link rel='stylesheet' href='assets/js/fullcalendar-2/fullcalendar.css' />
    <!--<link rel="stylesheet" href="assets/css/patient-queue.css"> FOR HOVER-->
    <link rel="stylesheet" href="assets/native/css/visitors.css">


    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <script type ="text/javascript" src = "assets/native/js/helper_functions.js"> </script>

    <!--[if lt IE 9]><script src="assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body class="page-body gray" data-url="http://neon.dev">

<div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->

    <div class="sidebar-menu">
        <div class="sidebar-menu-inner">
            <header class="logo-env">

                <!-- logo -->
                <div class="logo">
                    <a href="#">
                        <img src="images/logo-omni2-white.png" width="150" alt="" />
                    </a>
                </div>

                <!-- logo collapse icon -->
                <div class="sidebar-collapse">
                    <a href="#" class="sidebar-collapse-icon"><!-- add class "with-animation" if you want sidebar to have animation during expanding/collapsing transition -->
                        <i class="entypo-menu"></i>
                    </a>
                </div>

                <!-- open/close menu icon (do not remove if you want to enable menu on mobile devices) -->
                <div class="sidebar-mobile-menu visible-xs">
                    <a href="#" class="with-animation"><!-- add class "with-animation" to support animation -->
                        <i class="entypo-menu"></i>
                    </a>
                </div>

            </header>


            <ul id="main-menu" class="main-menu">
                <!-- add class "multiple-expanded" to allow multiple submenus to open -->
                <!-- class "auto-inherit-active-class" will automatically add "active" class for parent elements who are marked already with class "active" -->
                <li>
                    <a href="#">
                        <i class="entypo-users"></i>
                        <span class="title">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="/visitors.html">
                        <i class="entypo-users"></i>
                        <span class="title">Visitors</span>
                    </a>
                </li>
                <li>
                    <a href="/employees.html">
                        <i class="entypo-user"></i>
                        <span class="title">Employees</span>
                    </a>
                </li>
                <li>
                    <a href="/appointments.html">
                        <i class="entypo-calendar"></i>
                        <span class="title">Appointments</span>
                    </a>
                </li>
                <li>
                    <a href="#" onclick="openFormHelper();">
                        <i class="entypo-clipboard"></i>
                        <span class="title">Forms</span>
                    </a>
                </li>
                <li>
                    <a href="/settings.html">
                        <i class="entypo-tools"></i>
                        <span class="title">Settings</span>
                    </a>
                </li>
            </ul>

        </div>

    </div>

    <div class="main-content">
        <div class="row">

            <!-- Profile Info and Notifications -->
            <div class=" col-md-6 col-sm-8 clearfix">

                <ul class="user-info pull-left pull-none-xsm">
                    <!-- Profile Info -->
                    <li class="profile-info dropdown"><!-- add class "pull-right" if you want to place this from right -->
                        <div id="company-name">
                            <h1>Hello, <span id="user-name"> </span></h1>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Raw Links -->
            <div class="col-md-6 col-sm-4 clearfix hidden-xs pull-right">
                <a id="logoutButton_side" class="btn btn-primary btn-login" href="/index.html">
                    Log Out <i class="entypo-logout right"></i>
                </a>
            </div>
        </div>

        <hr />
        <div id='calendar'></div>
        <br>
        <h4>Appointments</h4>
        <div id="chart"></div>

    </div>
</div>

<script type ="text/javascript" src = "assets/native/js/dashboard.js"> </script>
<!-- Imported styles on this page -->
<!--<link rel="stylesheet" href="assets/js/jvectormap/jquery-jvectormap-1.2.2.css">
<link rel="stylesheet" href="assets/js/rickshaw/rickshaw.min.css">
-->
<!-- Bottom scripts (common) -->
<script src="assets/js/gsap/TweenMax.min.js"></script>
<script src="assets/js/jquery-ui/js/jquery-ui-1.10.3.minimal.min.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/joinable.js"></script>
<script src="assets/js/resizeable.js"></script>
<script src="assets/js/neon-api.js"></script>

<!--<script src="assets/js/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>-->


<!-- Imported scripts on this page -->


<!-- JavaScripts initializations and stuff -->
<script src="assets/js/neon-custom.js"></script>

<!-- Demo Settings -->
<script src="assets/js/neon-demo.js"></script>

<script src="assets/js/socket.io.js"></script>

<script type ="text/javascript" src="assets/native/js/login.js"></script>
<script src='assets/js/fullcalendar-2/lib/moment.min.js'></script>
<script src='assets/js/fullcalendar-2/lib/jquery.min.js'></script>
<script src='assets/js/fullcalendar-2/fullcalendar.js'></script>
<script src='bower_components/d3/d3.js'></script>

<script>
  $(document).ready(function() {
    // page is now ready, initialize the calendar...

    $('#calendar').fullCalendar({
      defaultView: "agendaWeek",
      timezone: "local",
      minTime: "07:00:00",
      maxTime: "18:00:00",
      header:{
        right:  'month,agendaWeek,agendaDay prev,next'
      },
      events: {
        url: '/calendarData',
        type: 'POST',
        data: {
          company_id: JSON.parse(localStorage.getItem('currentUser')).company_id
        },
        error: function() {
          alert('there was an error while fetching events!');
        },
        color: 'yellow',   // a non-ajax option
        textColor: 'black' // a non-ajax option
      }
    })

  });
</script>

<script>
  var width = 360;
  var height = 360;
  var radius = Math.min(width, height) / 2;

  var colors = ["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"];

  var svg = d3.select('#chart')
    .append('svg')
    .attr('width', width)
    .attr('height', height)
    .append('g')
    .attr('transform', 'translate(' + (width / 2) +
      ',' + (height / 2) + ')');

  var arc = d3.arc()
    .outerRadius(radius-10)
    .innerRadius(0);

  var labelArc = d3.arc()
    .outerRadius(radius - 40)
    .innerRadius(radius - 40);

  var pie = d3.pie()
    .value(function(d) {
      return d.count;
    })
    .sort(null);

  d3.json('/api/appointments/stats/' + JSON.parse(localStorage.getItem('currentUser')).company_id, function(error, data){
    if (error)
      throw error;
    var g = svg.selectAll(".arc")
      .data(pie(data))
      .enter().append("g")
      .attr("class", "arc");

    g.append("path")
      .attr("d", arc)
      .style("fill", function(d) {
        return colors[d.index]; });

    g.append("text")
      .attr("transform", function(d) { return "translate(" + labelArc.centroid(d) + ")"; })
      .attr("dy", ".35em")
      .text(function(d) {
        return d.data.status; });
  });
</script>

</body>
</html>
